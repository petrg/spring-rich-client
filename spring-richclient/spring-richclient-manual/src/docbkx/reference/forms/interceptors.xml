<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE partintro PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">

<chapter id="forms_interceptors">
    <title>Form Component Interceptors</title>
  
    <section id="form_interceptors_introduction">
        <title>Introduction</title>
        
        <para>Form Component Interceptors provide a way to intercept and add extra functionality to input components on a form.</para>
        
        <para>
            The application context specifies the list of interceptors to attach to controls constructed by the platform.
            This allows for a declarative model for specifying "additional" functionality to be added to various components.
        </para>
        
        <para>
            Examples are interceptors to overlay validation error images and background color changes, provide popup menus in text fields, and
            autocompletion (as you type) for comboboxes.
        </para>
    </section>
    
    <section id="form_interceptors_interface">
        <title>FormComponentInterceptor interface</title>
        
        <programlisting>
public interface FormComponentInterceptor {
    public void processLabel(String propertyName, JComponent label);

    public void processComponent(String propertyName, JComponent component);
}        </programlisting>

        <para>
            To create your own <classname>FormComponentInterceptor</classname>, you have to provide both a <classname>FormComponentInterceptor</classname> and a 
            <classname>FormComponentInterceptorFactory</classname> implementation.
        </para>
        
        <para>TODO: write more</para>
    </section>

    <section id="forms_interceptors_configuration">
        <title>Configuration</title>

        <para>The configuration of the interceptors in the application context is done by defining the <classname>FormComponentInterceptorFactory</classname>.</para>

        <para>Sample configuration:</para>

        <programlisting>&lt;bean id="formComponentInterceptorFactory" 
            class="org.springframework.richclient.form.builder.support.ChainedInterceptorFactory"&gt;
            &lt;property name="interceptorFactories"&gt;
                    &lt;list&gt;
                            &lt;bean class="org.springframework.richclient.form.builder.support.ColorValidationInterceptorFactory"&gt;
                                    &lt;property name="errorColor" value="255,200,200"/&gt;
                            &lt;/bean&gt;
                            &lt;bean class="org.springframework.richclient.form.builder.support.OverlayValidationInterceptorFactory"/&gt;
                            &lt;bean class="org.springframework.richclient.form.builder.support.DirtyIndicatorInterceptorFactory"/&gt;
                            &lt;bean class="org.springframework.richclient.text.TextComponentPopupInterceptorFactory"/&gt;
                            &lt;bean class="org.springframework.richclient.list.ComboBoxAutoCompletionInterceptorFactory"/&gt;
                    &lt;/list&gt;
            &lt;/property&gt;
    &lt;/bean&gt;</programlisting>
    </section>

    <section id="form_interceptors_builtin">
        <title>Built-in FormComponentInterceptors</title>
        
        <para>There are a number of built-in interceptors provided with the framework.</para>
  
        <section>
            <title>OverlayValidationInterceptor</title>
            
            <para>Shows an error image in the lower left corner of the component if
            the contents of the component is invalid. The image also has a tooltip
            showing the validation message.</para>
            
            <para>
                <citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.OverlayValidationInterceptorFactory</classname>
            </para>

            <mediaobject>
                    <imageobject>
                          <imagedata fileref="images/OverlayValidationInterceptor.png" />
                    </imageobject>
              </mediaobject>
        </section>
        
        <section>
            <title>ColorValidationInterceptor</title>

            <para>Changes the background color of the form component.</para>

            <para>
                <citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.ColorValidationInterceptorFactory</classname>
            </para>

            <para>Properties:</para>
            <itemizedlist>
                <listitem><para>errorColor: the background color</para></listitem>
            </itemizedlist>

            <para>Sample configuration:</para>

            <programlisting>
&lt;!-- This sets the error color to a nice "reddish" tint --&gt;
&lt;bean class="org.springframework.richclient.form.builder.support.ColorValidationInterceptorFactory"&gt;
        &lt;property name="errorColor" value="255,200,200"/&gt;
&lt;/bean&gt;</programlisting>

            <mediaobject>
                    <imageobject>
                          <imagedata fileref="images/ColorValidationInterceptor.png" />
                    </imageobject>
              </mediaobject>
          </section>
          
          <section>
                <title>TextComponentPopupInterceptor</title>
                
                 <para>Adds more advanced text editing functionality to text components. It adds a popup menu with "undo/redo/cut/copy/paste/select all" items. It also adds the standard keyboard accelerators for these commands to the component.</para>
                 
                 <para><citation>Factory class</citation>: <classname>org.springframework.richclient.text.TextComponentPopupInterceptorFactory</classname></para>

                             <mediaobject>
                    <imageobject>
                          <imagedata fileref="images/TextComponentInterceptor.png" />
                    </imageobject>
              </mediaobject>
          </section>
          
          <section>
                <title>ComboboxAutocompletionInterceptor</title>

                <para>Adds autocompletion to a combobox.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.list.ComboBoxAutoCompletionInterceptorFactory</classname></para>

                <mediaobject>
                    <imageobject>
                          <imagedata fileref="images/ComboboxAutocompletionInterceptor.png" />
                    </imageobject>
               </mediaobject>
          </section>

          <section>
                <title>DirtyIndicatorInterceptor</title>
                
                <para>Shows an image in the top left corder of the component if the contents of the component has been changed by the user. The image also has a tooltip showing the original value. To the right of the image is a small revert button. Pushing this button restores the original value in the component.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.DirtyIndicatorInterceptorFactory</classname></para>

                <para>Properties:</para>
                <itemizedlist>
                    <listitem>
                        <para>includedFormModelIds: list of form models that should display the Dirty Indicator.</para>
                        <para>Only one of includedFormModelIds or excludedFormModelIds can be specified.</para>
                    </listitem>
                    <listitem>
                        <para>excludedFormModelIds: list of form models that should not display the Dirty Indicator</para>
                        <para>Only one of includedFormModelIds or excludedFormModelIds can be specified.</para>
                    </listitem>
                </itemizedlist>

                <programlisting>
&lt;!-- The login form will not show the Dirty Indicator --&gt;
&lt;bean class="org.springframework.richclient.form.builder.support.DirtyIndicatorInterceptorFactory"&gt;
        &lt;property name="excludedFormModelIds"&gt;
                &lt;list&gt;
                        &lt;value>loginForm&lt;/value&gt;
                &lt;/list&gt;
        &lt;/property&gt;
&lt;/bean&gt;</programlisting>

                <mediaobject>
                    <imageobject>
                          <imagedata fileref="images/DirtyIndicatorInterceptor.png" />
                    </imageobject>
               </mediaobject>

          </section>
          
          <section>
                <title>SelectAllFormComponentInterceptor</title>
                
                <para>Selects all the text in text fields and spinners when they receive focus.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.text.SelectAllInterceptorFactory</classname></para>

                <mediaobject>
                    <imageobject>
                          <imagedata fileref="images/SelectAllInterceptor.png" />
                    </imageobject>
               </mediaobject>
          </section>
          
          <section>
                <title>TextCaretComponentInterceptor</title>
                
                <para>If the text is set in a text component, the caret position is set to the end of the text.</para>
                <para>This means the beginning of the text will not be visible if the text is too long to fit in the text component.</para>
                <para>This <classname>FormComponentInterceptor</classname> "fixes" this behaviour, and sets the caret to position 0.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.text.TextCaretFormComponentInterceptorFactory</classname></para>
          </section>       
          
          <section>
                <title>ToolTipInterceptor</title>
                
                <para>If a form property has a caption defined in the messages.properties file it will be used as the tooltip for the form component.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.ToolTipInterceptorFactory</classname></para>
                
                <para>Properties:</para>
                <itemizedlist>
                    <listitem>
                        <para>processComponent: default is true, determines whether the tooltip of the component is set.</para>
                    </listitem>
                    <listitem>
                        <para>processLabel: default is true, determines whether the tooltip of the label is set.</para>
                    </listitem>
                </itemizedlist>
          </section>       
          
          <section>
                <title>CheckBoxFormComponentInterceptor</title>
                
                <para>Allows customization on how a CheckBox form property is rendered.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.CheckBoxFormComponentInterceptorFactory</classname></para>
                
                <para>Properties:</para>
                <itemizedlist>
                    <listitem>
                        <para>showLabel: default is true, determines whether the label will be shown.</para>
                    </listitem>
                    <listitem>
                        <para>showText: default is false, determines whether the label text will be used as text for the checkbox itself.</para>
                    </listitem>
                    <listitem>
                        <para>textKey: default is "text", the key used to fetch the text to show.</para>
                    </listitem>
                </itemizedlist>
          </section> 

          <section>
                <title>ShowCaptionInStatusBarInterceptor</title>
                
                <para>Shows the caption of the form component in the statusbar when the component is focused.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.ShowCaptionInStatusBarInterceptorFactory</classname></para>
          </section>           

          <section>
                <title>ShowDescriptionInStatusBarInterceptor</title>
                
                <para>Shows the description of the form component in the statusbar when the component is focused.</para>

                <para><citation>Factory class</citation>: <classname>org.springframework.richclient.form.builder.support.ShowDescriptionInStatusBarInterceptorFactory</classname></para>
          </section>           
          
    </section>
</chapter>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!--
  - $Id$
  -->

<beans>

	<!-- =================== SECURITY SYSTEM DEFINITIONS ================== -->
	
	<!-- ~~~~~~~~~~~~~~~~~~~~ AUTHENTICATION DEFINITIONS ~~~~~~~~~~~~~~~~~~ -->
	
	<bean id="authenticationManager" class="org.acegisecurity.providers.ProviderManager">
		<property name="providers">
		  <list>
		    <ref bean="daoAuthenticationProvider"/>
		  </list>
		</property>
	</bean>
	
	<bean id="daoAuthenticationProvider" class="org.acegisecurity.providers.dao.DaoAuthenticationProvider">
     	<property name="userDetailsService"><ref bean="userDetailsService"/></property>
	</bean>

	<bean id="userDetailsService" class="org.acegisecurity.userdetails.jdbc.JdbcDaoImpl">
		<property name="dataSource"><ref bean="dataSource"/></property>
	</bean>

	<bean id="basicProcessingFilter" class="org.acegisecurity.ui.basicauth.BasicProcessingFilter">
		<property name="authenticationManager"><ref bean="authenticationManager"/></property>
		<property name="authenticationEntryPoint"><ref bean="basicProcessingFilterEntryPoint"/></property>
	</bean>

	<bean id="basicProcessingFilterEntryPoint" class="org.acegisecurity.ui.basicauth.BasicProcessingFilterEntryPoint">
		<property name="realmName"><value>Petclinic RCP Client-Server Realm</value></property>
	</bean>

	<bean id="autoIntegrationFilter" class="org.acegisecurity.adapters.HttpRequestIntegrationFilter" />

	<!-- Automatically receives AuthenticationEvent messages from DaoAuthenticationProvider -->
	<bean id="loggerListener" class="org.acegisecurity.event.authentication.LoggerListener"/>

	<!-- Allows remote clients to check if a username/password is valid -->
	<bean id="remoteAuthenticationManager" class="org.acegisecurity.providers.rcp.RemoteAuthenticationManagerImpl">
     	<property name="authenticationManager"><ref bean="authenticationManager"/></property>
	</bean>

</beans>
